<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Products | ShopKart</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/stylesheets/tailwind.css" />
  </head>
  <body>
    <div class="main w-full min-h-screen">
      <!-- flash message -->
      <% if(success.length > 0){ %>
      <div
        class="alert text-center bg-green-500 w-full h-16 absolute top-0 z-50 md:w-1/3 md:right-1/2 rounded-b-3xl pt-5 md:translate-x-1/2"
      >
        <span class="text-black font-semibold"><%= success %></span>
      </div>
      <% } else if(flash.length > 0){ %> 
        <div
        class="alert text-center bg-red-500 w-full h-16 absolute top-0 z-50 md:w-1/3 md:right-1/2 rounded-b-3xl pt-5 md:translate-x-1/2"
      >
        <span class="text-black font-semibold"><%= flash %></span>
      </div>
      <% } %>
      
      
      <%- include('./header') %>

      <section class="min-h-screen w-full flex flex-col md:flex-row">
        <!-- sidebar -->
        <aside
          class="bg-gray-800 text-white w-full md:w-[25vw] md:h-screen p-4 h-14 overflow-hidden sticky top-16 z-10"
        >
          <h2 class="text-2xl font-bold mb-4">
            Products
            <span class="filter text-blue-500 ml-2 text-xl md:hidden"
              >filter<i
                class="fa-solid fa-down-long transition ease-in-out delay-150 hover:text-white"
              ></i
            ></span>
          </h2>
          <ul class="space-y-2">
            <li>
              <a
                href="#"
                class="block py-2 px-4 rounded hover:bg-gray-700 text-blue-500"
                >Sort By:</a
              >
              <ul class="pl-4 space-y-1">
                <li>
                  <a href="/shop/popular" class="block py-1 px-2 rounded hover:bg-gray-700"
                    >Popular Collection</a
                  >
                </li>
                <li>
                  <a href="/shop/new" class="block py-1 px-2 rounded hover:bg-gray-700"
                    >New Collection</a
                  >
                </li>
              </ul>
            </li>
          </ul>

          <ul class="mt-36">
            <li>
              <a
                href="#"
                class="block py-2 px-4 rounded hover:bg-gray-700 text-blue-500"
                >Filter By:</a
              >
              <ul class="pl-4 space-y-1">
                <li>
                  <a href="/shop/availability" class="block py-1 px-2 rounded hover:bg-gray-700"
                    >Availability</a
                  >
                </li>
                <li>
                  <a href="/shop/discount" class="block py-1 px-2 rounded hover:bg-gray-700"
                    >Discount</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </aside>

        <div class="products min-h-screen md:w-[75vw]">
          <h2 class="text-3xl font-bold mb-4 text-center">
            "Healthy Living, Boundless Adventure"
          </h2>

          <div class="p-2 grid grid-cols-2 md:grid-cols-4 gap-4">
            <% products.forEach(product => { %>

            <div
              class="product bg-[<%= product.panelcolor %>] flex flex-col border-black border-2 col-span-1 md:h-[45vh]"
            >
              <div class="h-[25vh] md:h-[60%]">
                <img
                  src="data:image/*;base64,<%= product.image.toString('base64') %>"
                  alt="<%= product.name %>"
                  class="h-full w-full object-cover overflow-hidden bg-gray-600"
                />
              </div>
              <div class="p-4 flex-wrap text-[<%= product.textcolor %>]">
                <h3 class="text-lg font-semibold"><%= product.name %></h3>
                <% if(product.discount > 0){ %>
                <p class="text-orange-500 text-lg">
                  Discount: &#8377;<%= product.discount %>
                </p>
                <% } %>
                <div class="flex justify-between items-center">
                  <span class="text-sm font-semibold"
                    >&#8377; <%= Number(product.price) %></span
                  >
                  <a href="users/cart/add/<%= product._id %>"
                    ><i
                      class="fa-solid fa-plus bg-black text-orange-500 rounded-full flex justify-center items-center p-2"
                    ></i
                  ></a>
                </div>
              </div>
            </div>

            <% }); %>
          </div>
        </div>
      </section>

      <%- include('./footer') %>
    </div>

    <script src="/js/shop.js"></script>
    <script src="/js/common.js"></script>
  </body>
</html>
